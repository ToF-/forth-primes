850 160 * CONSTANT MAX-PRIME
CREATE PTABLE
HEX
58D42F4AB5A75AF7 ,
74235A51AE10F1A6 ,
874AB1894AA4AC50 ,
10E5A45A45030A94 ,
442952A4891261A7 ,
2548940742E08F18 ,
4A740B18B1A85254 ,
C0885A612512300A ,
AE0881250005875A ,
4294AA1210AF10B4 ,
A52308E00E4045AD ,
2508F50412110E40 ,
0A208C52E4A01830 ,
C12600812358308F ,
AB5055A018652C12 ,
5A91020064854250 ,
B4AE52C421483080 ,
8152608358442918 ,
4291801A60844A44 ,
150E0041880A8509 ,
861AA58010F0094A ,
50900F4820241831 ,
708252642310C5AC ,
2302608D00A48950 ,
0804061AD4094234 ,
E0AC10B0A05805A7 ,
004A31A318D10040 ,
02550308502248C4 ,
C10252050C02E423 ,
AE00902B0210A25A ,
52708A0851001061 ,
A5854090831AA42C ,
A100740848942400 ,
50E4A50014220A41 ,
112A40158702D00B ,
0B40512A08F58200 ,
02418D5A85251280 ,
A426481405002086 ,
0952C02212312118 ,
48A5A24A51845A44 ,
3409001128180500 ,
8B18A1A04084815A ,
1A412E0231830060 ,
84A152558C005482 ,
2440900D0A008842 ,
18310C42002648B4 ,
448D40D020502008 ,
280A81061A618D4A ,
0A402800E1064295 ,
200218648502E421 ,
0402512D08A08058 ,
50742A0271881095 ,
05061A800C4A2008 ,
0E08C12202C52100 ,
02812550A4A94A05 ,
112A00240708D186 ,
0A10048B0835801A ,
4041850A85215064 ,
F1A250500B429023 ,
040014A11050A700 ,
0AA18048C10A1AA1 ,
050610D0A852150C ,
8D00C00C0024091A ,
0210214A91A012B0 ,
90084271230834A6 ,
8018218442E02C00 ,
1814065094254804 ,
05A45000891020AA ,
040224A048C00A1A ,
40718810E02618C4 ,
30095084A1528020 ,
825A14064210A208 ,
4040214064801804 ,
B5250AC00210C189 ,
0518A1A60A440600 ,
4A00AD40300B4014 ,
01094A3184124003 ,
A050612910E0060A ,
40B10A4825845254 ,
91024281224810A5 ,
A102D4A800210B08 ,
0AA0020A600F02A4 ,
048908C006529405 ,
0150C10400D42850 ,
5044204220844A51 ,
D00B1875880824A0 ,
2702E08118048902 ,
10502818C0060031 ,
01044060AA000407 ,
0C0805070221001A ,
5A608208810C5295 ,
60820860AD003003 ,
8C1215204294A552 ,
10600208548A0054 ,
A42108D105126120 ,
8818A48C5A812440 ,
1060251284211261 ,
950F088503089104 ,
024A542508F40002 ,
10308042A50D4080 ,
018412542F402005 ,
810024281A402E00 ,
40342550010B08A0 ,
3086002524088025 ,
0402850802B02158 ,
0255030A90021A10 ,
44A040252D102582 ,
0040900E1A048042 ,
10C12E40912540B0 ,
C1A81080885A540A ,
0C48240308C00608 ,
1A110210C4041A01 ,
418F00200D50C08B ,
2A5091080A358048 ,
40942108350C0870 ,
218342210152A421 ,
A110910040402600 ,
0880800264204A10 ,
502900A08400F080 ,
030241810005A810 ,
00208908248850B4 ,
050A5A452F4215A0 ,
0100000A4250A310 ,
00A12042B08448C5 ,
70A30844A0180523 ,
0E0A650812140B10 ,
0044090830810261 ,
C0031014A808E526 ,
8410A0021A210C02 ,
0830AE10C4210201 ,
848902C4A048000C ,
0508058012F10302 ,
48040510348A4A81 ,
208552C00502E002 ,
8C4AC00B42B50400 ,
50C42102210C0071 ,
1021129181428424 ,
A610D42250410248 ,
08002810E42A1830 ,
510C0A000612F084 ,
0B10110308252008 ,
48D08812C1A00034 ,
51A0005406481185 ,
8D52202302410500 ,
48248210408512E1 ,
40A510708810040B ,
0840208410408018 ,
5A002E0AA10748D0 ,
34A108252700800C ,
2150400858A4A840 ,
10612E52510A0A85 ,
400100148A024188 ,
280281A410B08048 ,
1210201014244881 ,
A106082008525080 ,
2202C40840950108 ,
50442040702008D4 ,
012648800A1A2405 ,
821810244A810F00 ,
0AC1014200001A64 ,
85204220A442A10B ,
A208240D0081A012 ,
00210942C10812B0 ,
440A0A512100B482 ,
A410448148600718 ,
4080214880885244 ,
71A7080524005021 ,
8308A1210240805A ,
10502500B4050231 ,
508002040E106582 ,
0048008350A18010 ,
08058048540C4005 ,
202410500300118C ,
064AB0A61AE00158 ,
42052700C1220014 ,
100218C508501481 ,
8C4AC00008910302 ,
4204A81A24001800 ,
158650B08D4060A0 ,
2810B00A12440B4A ,
0825090094824064 ,
0100428027480081 ,
0812110D10A4245A ,
4A118E0204A41244 ,
852C005401022022 ,
A10240021A012810 ,
4001A61060820801 ,
108408300A008405 ,
0212450900E0AA58 ,
18040502A42018A1 ,
E08848700C081402 ,
2648510A50002040 ,
18B1884A01224004 ,
A0A0025009501021 ,
2B40B48300118A10 ,
4065840054AC5280 ,
7009480000007480 ,
064A040502240710 ,
0040A018110F0084 ,
112240000412208C ,
8300C08A4AD00C0A ,
0AC0015060221A20 ,
84030A31015AA107 ,
211A04AB00700650 ,
4A900800E4240024 ,
41A058040802B003 ,
A41230284A20A618 ,
0004021291811800 ,
042A1040AE18510C ,
8D4A042902248940 ,
5881220080054AE1 ,
102812500C18502C ,
0140B08040050152 ,
10700210C50E0000 ,
010D1044A34225A0 ,
0A40B18618408902 ,
0224A41810261A00 ,
500F00840102C489 ,
060001030880A042 ,
0010A908548B08B0 ,
2086501184500501 ,
0C10010C42852102 ,
5000004270280275 ,
D00B4010A4180000 ,
A24A102210C08A10 ,
10500C4225004074 ,
A4A04A1108481401 ,
AC5020000A202300 ,
48048612910E0060 ,
3585088128525022 ,
061AA18450442108 ,
4044014881A240A0 ,
6022024189108082 ,
0208408B40C12C00 ,
18B50C48552A0205 ,
040040B0024A2084 ,
0448912410308300 ,
0824801074065000 ,
D0814A442800A002 ,
2050102D42852100 ,
4200010001AC1000 ,
34A05830881A200D ,
2510A10212040C4A ,
02802050A0234210 ,
910340A0A6488007 ,
830261200011AC48 ,
1A80011280884234 ,
94801284010A1101 ,
8D00908908248A00 ,
0A90204801064A45 ,
300E10A40200D028 ,
000A40215020284A ,
10802E0004015200 ,
C4085240821884A6 ,
0412908008E00000 ,
08A40242842D0AA1 ,
6001405482502021 ,
0A4235230AC10B10 ,
00308D0051200081 ,
60800A81A4108422 ,
804880050895055A ,
1264821A00290051 ,
310202E08308E504 ,
870865884090010A ,
50A0885204A30040 ,
402008942752600E ,
8B4A440B00100858 ,
02A1890064241244 ,
40A20885224A0180 ,
0840902042200618 ,
0011A01211004205 ,
408500510412D000 ,
0918242C50E00300 ,
00012F40A0015010 ,
542B122020180420 ,
801A910C10A10D40 ,
0021AE4801070890 ,
002800400B105000 ,
234004820A708552 ,
4870210811860055 ,
A084482484128088 ,
8002412000240612 ,
02842000518100D5 ,
A42208410348C429 ,
8C08612202510000 ,
5040045064811020 ,
00240A2127400086 ,
211805000890AA00 ,
48808710252002B0 ,
810018440D00B100 ,
8802148850558010 ,
0215820AA0811824 ,
452018D400185406 ,
0040600040208108 ,
08010E4A902400D1 ,
30804A6488104104 ,
2550008110C40D02 ,
00E08A08910A0225 ,
408C50C003407181 ,
014A14A052010842 ,
40118810A0080A40 ,
3081108481006482 ,
A208402C42102140 ,
0290281201A60055 ,
858550300000E10C ,
2400040A18C40348 ,
4A010842708A1820 ,
C1200215A0584083 ,
2858300E00B00440 ,
40008C5A00814290 ,
458410410E00A422 ,
8010502212150E00 ,
48342300B00042C5 ,
15040040A41A9124 ,
0642812910142300 ,
1A84224001810250 ,
040210140400B500 ,
2448A10008642102 ,
10012818500A0830 ,
E008507008001186 ,
0F08040602418842 ,
5205A108D5A40201 ,
A0845024A1421081 ,
8C42440C0801A012 ,
1070090824A018A0 ,
240502010C500508 ,
211804A842010B42 ,
00602000148B0001 ,
9408029523085108 ,
0208442518502400 ,
5040830A81804064 ,
612C481400428126 ,
8C00B00148310C08 ,
40950140A0060881 ,
7008180406008021 ,
8010C0A10060AA58 ,
40D5014810A01260 ,
0088403124009086 ,
0040210610A10112 ,
0055041290244810 ,
858142E0080A41AB ,
2800A4041A410342 ,
4810280084A41005 ,
010902A08900C401 ,
001204044A00A158 ,
12F02010008A08E5 ,
1104084180108120 ,
2700B18A08800508 ,
4AE4A40200215051 ,
440408350348100A ,
081221A50021800A ,
10800E08C00C4094 ,
E422504122488020 ,
2810D00802348B08 ,
02A4045031051280 ,
510B18702042052C ,
844860854000AA02 ,
1891030230A20A90 ,
04204A240C180106 ,
2410C00C02240440 ,
1054A84884294001 ,
418100A4880A3520 ,
254A142010600602 ,
5854A81834081880 ,
308E004128001002 ,
0A40100140318452 ,
10A48140102300A4 ,
000010000C124124 ,
0B18508602412D48 ,
42048902A4224A30 ,
D12000012202A18C ,
2840342700C4A448 ,
1A900D5001054080 ,
20085090260A04A0 ,
8110500900048200 ,
08A4071A40014860 ,
402810D00248000D ,
004A042042202250 ,
5255080000850860 ,
20A340648208818C ,
2242E18C08800110 ,
0090005214050001 ,
0120121000083109 ,
004A018242B00052 ,
0201A60094261A01 ,
500A42052452542A ,
0800910240A00100 ,
1064805215850824 ,
20A5181003588081 ,
0200140612C02000 ,
08A0054264800241 ,
010600A0A4425102 ,
2910048110212212 ,
18000F18008D0240 ,
C08008142240A480 ,
2450708140050010 ,
00A4260281885845 ,
148C08558C408125 ,
820AA12102448A58 ,
4040080825000261 ,
70020811060060A4 ,
8302900052400C10 ,
0030A00281200024 ,
252910C42000208A ,
2302040048208700 ,
10458110D0280050 ,
918812202C124008 ,
0C40802202B4050A ,
42A4211060060824 ,
858252C18040800C ,
0018E58440542848 ,
00810412D4080841 ,
140548002302500D ,
810010A900400E0A ,
0261864001201000 ,
212A089006481022 ,
2142002208412418 ,
42310108500218A1 ,
210200608E12800A ,
0D0861890200A14A ,
0A800408310410F0 ,
10A940242D189008 ,
8010108508C48452 ,
08850A42D1220880 ,
248542B401120422 ,
0500308410A10200 ,
1001810084AC0011 ,
600E400088101008 ,
A01041040291051A ,
10540A4830860880 ,
04044AD1820001A0 ,
8800250018912002 ,
02C4A10270021A04 ,
94030A9001406000 ,
2000408000F12640 ,
00C0085041200200 ,
108040C42D080087 ,
8510808B50008118 ,
4A05834241835080 ,
21A0100528481009 ,
0848050D00D08A00 ,
4804064085840A30 ,
C42B020022082008 ,
8210D1885841A110 ,
1015260880090880 ,
A5AC402403486008 ,
0202B02248B08C02 ,
12042000600A1844 ,
410C08410100B4A0 ,
A61205204885850A ,
00800B1860261080 ,
240458300F10002D ,
0D00110002842140 ,
0260004094200261 ,
400600A48508B10E ,
A852152A18800240 ,
00108302C0A84060 ,
4082400009000125 ,
2140048B10140A10 ,
4A11240A400250A0 ,
500508A1A012402C ,
0442448C02800210 ,
5014054080211280 ,
108B48458A1001A0 ,
0342600250648040 ,
10150C08102900B0 ,
E484002002184425 ,
2942150040918418 ,
48700000812A0254 ,
210D082008028001 ,
244A040848208658 ,
1200800050071844 ,
80A108D0025061A5 ,
2100652402110E0A ,
5A84015020020820 ,
C40A029180009003 ,
020A01AA10240002 ,
12010302048C0220 ,
1006408103409425 ,
015060204040A418 ,
0A00A40230045881 ,
012108050A421003 ,
8F0AC02110142140 ,
10C0024894824010 ,
142A5A052818D004 ,
0612B08D00850150 ,
00A0060880214221 ,
8089104482481028 ,
280230A640C10100 ,
0004050055024081 ,
218058448400C401 ,
2450002A02042258 ,
4060820A55800041 ,
900008C00108812C ,
2500B4A012040202 ,
48608902A0811801 ,
002100102610E084 ,
0840352908818850 ,
0A710048400000F4 ,
C4A4028007082507 ,
2D00140050108100 ,
4804A210B10C1064 ,
300C0804040A0508 ,
0D12800440442018 ,
0AC10C4021075850 ,
202A58400208308A ,
8142500F12E10802 ,
0000A202C1224010 ,
81090030AA1004A3 ,
000AB42448000240 ,
08440708540C4890 ,
8182082480408029 ,
2410D12E00342258 ,
52C42A1221880000 ,
2421188005008501 ,
881804A61A400100 ,
0080005020A91015 ,
00044030A502C00F ,
020A41020080221A ,
0040004041285284 ,
418010802C423586 ,
0040508A52458A00 ,
0221814850834040 ,
202010610040C108 ,
060800A112102842 ,
0255000805A40050 ,
E48002048B109182 ,
064A510518400C00 ,
1800080090230A81 ,
24011050A15020A8 ,
0400A00018C00418 ,
0A350108450810C5 ,
00864A21A0008421 ,
8C10010B00302240 ,
4050081260040834 ,
102052100D028585 ,
0A08002658C02100 ,
48000C5090000030 ,
8009429102507002 ,
8918710210740A4A ,
00B0091045210220 ,
902840000C0084A1 ,
0952402002142208 ,
40302108908E0000 ,
0580182186021009 ,
804260A140700310 ,
5811200225060200 ,
900B1A200E00E582 ,
2012600412818152 ,
1061821050054820 ,
0008402088004087 ,
0108018142100048 ,
1A000610408000C5 ,
000C1800040220A0 ,
A810050900010752 ,
10408242252200F5 ,
A5061851014A6008 ,
2900542A08002042 ,
1060A51200084220 ,
D0070025A110408A ,
A000000918E02412 ,
48D00408A1884284 ,
34A012D50A428082 ,
8442D42208050408 ,
40B0A00020091204 ,
042E10812800C007 ,
0A40C08510C08200 ,
0205230224000810 ,
2088485004105504 ,
A202B18D00C18000 ,
00100A52002A4800 ,
20A002E02210652C ,
2000910012700108 ,
4235011060201210 ,
400D528108002401 ,
220094024011200A ,
50400812658208E0 ,
858010A1874A6420 ,
8600210C50000608 ,
1885204244A31845 ,
D10500A007481109 ,
224A40A400012400 ,
02718800848810B0 ,
04840250004A8407 ,
0102E00A02758200 ,
0080830200004805 ,
312C101004180403 ,
8248200C42940942 ,
0885000830015880 ,
C0801A150C102120 ,
871820024205A500 ,
0824001801224221 ,
200D429029500406 ,
050AA00118200608 ,
18402210152E1200 ,
00845004A540B0A2 ,
0402950308A12208 ,
0010294241090894 ,
00A31A2004526500 ,
0C10C40A50112840 ,
4840004080A20061 ,
00290A8023108184 ,
895210810040205A ,
00010D0060044064 ,
C48A48D002401502 ,
A010142000540700 ,
42012000810748A0 ,
008110200458D004 ,
0A0045AC00040302 ,
02D12C02118002A1 ,
000810042018002C ,
8002918F08200C50 ,
0045005804250214 ,
05240080020A0101 ,
0C48040740C00850 ,
02208410A4A20894 ,
70080A0185004023 ,
2C08400D00A00058 ,
0260A102248C18E4 ,
112008F08A0A8021 ,
0C00400840D12200 ,
0044080090095054 ,
850202140152900E ,
AA4824050021AC08 ,
1811000A05015080 ,
0000000130042A50 ,
800000000000000C ,
54455346464F2D50 ,
202020205449422D ,
00000001025EBBD0 ,
00000001025F6BC4 ,
00000001025EF8B8 ,
0000000000000014 ,
00000001025F07B8 ,
00000001025EF8B8 ,
0000000000000005 ,
00000001025F0644 ,
00000001025F0D6C ,
00000001025F6A78 ,
00000001025EF8B8 ,
000000000000000A ,
00000001025F07B8 ,
00000001025EF8B8 ,
0000000000000003 ,
00000001025F07B8 ,
00000001025F23B8 ,
00000001025ED024 ,
000000013004EEA8 ,
00000001025EF8B8 ,
0000000000000001 ,
00000001025ECF1C ,
000000013004EEB8 ,
00000001025EF8B8 ,
00000001025EF9D0 ,
00000001025EC9AC ,
000000013004EDC8 ,
800000000000000E ,
2D454C4241542D50 ,
202054455346464F ,
00000001025EBBD0 ,
00000001025F6BC4 ,
00000001025EF8B8 ,
0000000000000014 ,
00000001025F0644 ,
00000001025F6A78 ,
00000001025EC690 ,
000000013004EDF8 ,
00000001025EC9AC ,
000000013004EEC8 ,
800000000000000E ,
2D454C4241542D50 ,
202021454D495250 ,
00000001025EBBD0 ,
00000001025EC690 ,
000000013004EEF8 ,
00000001025EF8B8 ,
0000000000000001 ,
00000001025F6A78 ,
00000001025F228C ,
00000001025F6A78 ,
00000001025EF8B8 ,
0000000130042A78 ,
00000001025EF9D0 ,
00000001025F6BC4 ,
00000001025F8308 ,
00000001025F6D08 ,
00000001025F1DF4 ,
00000001025F6A78 ,
00000001025F8454 ,
00000001025EC9AC ,
000000013004EF38 ,
800000000000000E ,
2D454C4241542D50 ,
20203F454D495250 ,
00000001025EBBD0 ,
00000001025F6BC4 ,
00000001025EF8B8 ,
0000000000000002 ,
00000001025F07B8 ,
00000001025F23B8 ,
00000001025ED024 ,
000000013004F080 ,
00000001025EF8B8 ,
0000000000000002 ,
00000001025F2A8C ,
00000001025ECF1C ,
000000013004F140 ,
00000001025F6BC4 ,
00000001025EF8B8 ,
0000000000000005 ,
00000001025F07B8 ,
00000001025F23B8 ,
00000001025ED024 ,
000000013004F0E0 ,
00000001025EF8B8 ,
0000000000000005 ,
00000001025F2A8C ,
00000001025ECF1C ,
000000013004F140 ,
00000001025EC690 ,
000000013004EEF8 ,
00000001025F6A78 ,
00000001025EF8B8 ,
0000000130042A78 ,
00000001025EF9D0 ,
00000001025F8308 ,
00000001025EF8B8 ,
0000000000000001 ,
00000001025F6D08 ,
00000001025F228C ,
00000001025F1CCC ,
00000001025EC9AC ,
000000013004EFF0 ,
800000000000000B ,
4154502D54494E49 ,
2020202020454C42 ,
00000001025EBBD0 ,
00000001025ECF1C ,
000000013004F1A0 ,
696C616974696E69 ,
61747020676E697A ,
2020202E2E656C62 ,
00000001025EF8B8 ,
000000013004F188 ,
00000001025EF8B8 ,
0000000000000015 ,
00000001025ECBDC ,
0000000130004FA8 ,
00000001025EF8B8 ,
00000000000186A0 ,
00000001025EF8B8 ,
0000000000000001 ,
00000001025EE34C ,
00000001025EEA80 ,
00000001025EC690 ,
00000001300429A8 ,
00000001025ED024 ,
000000013004F238 ,
00000001025EEA80 ,
00000001025EC690 ,
000000013004EF68 ,
00000001025ED7B0 ,
000000013004F1F8 ,
00000001025ECAC4 ,
00000001025EC9AC ,
000000013004F148 ,
8000000000000002 ,
202020202020482E ,
00000001025EBBD0 ,
00000001025EC690 ,
0000000130004DB0 ,
00000001025EF8B8 ,
00000001025EC690 ,
0000000130005818 ,
00000001025EF8B8 ,
0000000000000010 ,
00000001025EF8B8 ,
00000001025EE34C ,
00000001025EC690 ,
0000000130005A00 ,
00000001025ED7B0 ,
000000013004F2D8 ,
00000001025ECAC4 ,
00000001025EC690 ,
00000001300057A0 ,
00000001025ECBDC ,
0000000130004FA8 ,
00000001025EC690 ,
0000000130005340 ,
00000001025EC690 ,
00000001300058C0 ,
00000001025EC690 ,
0000000130004D58 ,
00000001025EC9AC ,
000000013004F258 ,
8000000000000007 ,
20454C424154502E ,
00000001025EBBD0 ,
00000001025EC690 ,
0000000130004DB0 ,
00000001025EF8B8 ,
0000000130042A78 ,
00000001025EF8B8 ,
000000000000C350 ,
00000001025F8984 ,
00000001025F67F0 ,
00000001025EF9D0 ,
00000001025F6A78 ,
00000001025EE34C ,
00000001025EEA80 ,
00000001025F7DD8 ,
00000001025F6BC4 ,
00000001025ED024 ,
000000013004F430 ,
00000001025EC690 ,
000000013004F280 ,
00000001025EC690 ,
00000001300052F8 ,
00000001025ECF1C ,
000000013004F438 ,
00000001025F6934 ,
00000001025EF8B8 ,
0000000000000008 ,
00000001025EDA38 ,
000000013004F3D8 ,
00000001025ECAC4 ,
00000001025EC9AC ,
000000013004F358 ,
800000000000000B ,
4154502D54534554 ,
2020202020454C42 ,
00000001025EBBD0 ,
00000001025EF8B8 ,
00000000000186A0 ,
00000001025EF8B8 ,
0000000000000002 ,
00000001025EE34C ,
00000001025EEA80 ,
00000001025EC690 ,
000000013004F020 ,
00000001025ED024 ,
000000013004F510 ,
00000001025EEA80 ,
00000001025EC690 ,
0000000130005E40 ,
00000001025EC690 ,
00000001300052F8 ,
00000001025ED7B0 ,
000000013004F4C0 ,
00000001025ECAC4 ,
00000001025EC9AC ,
DECIMAL

: P-OFFSET-BIT ( n -- b )
    DUP 20 MOD 5 / 2* 
    SWAP 10 MOD 3 MOD 0= IF 1 ELSE 0 THEN + ;

\ to find which byte stores info about number n, o = n/20
\ to find which bit stores info about number n at offset o, i = 7-j
\ where j = (n%20)/5 * 2 + ((n%10)%3==0) ? 1 : 0

: P-TABLE-OFFSET ( p -- n,b ) \ p is prime, 5 < p < 1000000
    DUP 20 /
    SWAP P-OFFSET-BIT ;


: PRIME? ( n -- f )
    DUP 2 MOD 0= IF 2 = ELSE DUP 5 MOD 0= IF 5 =
    ELSE
        P-TABLE-OFFSET
        SWAP PTABLE + C@
        1 ROT LSHIFT AND
    THEN THEN ;

: TEST-PRIMES
    0
    MAX-PRIME 2 DO
        I DUP .
        PRIME? IF
            42 EMIT
            1+
        THEN
        CR
    LOOP 
    . ." PRIMES" ;

test-primes
bye
